// src/lib/api.ts

interface ContactFormData {
  name: string;
  email: string;
  phone?: string;
  company?: string;
  message: string;
}

interface FormData {
  name: string;
  email: string;
  inquiryType: string;
  other?: string;
  message: string;
}

// Firebase Hosting経由でアクセス（相対パスを使用）
const API_ENDPOINTS = {
  contact: '/api/contact',
  form: '/api/form',
  instagram: '/api/instagram'
};

export const api = {
  contact: async (data: ContactFormData) => {
    const response = await fetch(API_ENDPOINTS.contact, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data),
    });
    
    if (!response.ok) {
      const errorData = await response.json().catch(() => null);
      throw new Error(errorData?.message || '送信に失敗しました');
    }
    
    return response.json();
  },
  
  form: async (data: FormData) => {
    const response = await fetch(API_ENDPOINTS.form, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data),
    });
    
    if (!response.ok) {
      const errorData = await response.json().catch(() => null);
      throw new Error(errorData?.message || '送信に失敗しました');
    }
    
    return response.json();
  },
  
  instagram: {
    getPhotos: async () => {
      const response = await fetch(API_ENDPOINTS.instagram, {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      });
      
      if (!response.ok) {
        throw new Error('Instagram写真の取得に失敗しました');
      }
      
      return response.json();
    }
  }
};